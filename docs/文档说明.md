# 📝 文档更新说明

## ✅ 2025-01-15 更新：迁移到 Supabase

### 主要变更

项目数据库已从本地 PostgreSQL 迁移到 **Supabase**（托管 PostgreSQL）。

### 更新的文件

#### 1. 配置文件

- ✅ `prisma/schema.prisma` - 添加 `directUrl` 支持
- ✅ `.env.example` - 更新为 Supabase 连接字符串模板

#### 2. 文档

- ✅ **[Supabase配置指南.md](./技术文档/Supabase配置指南.md)** - 新增完整配置教程
- ✅ **[快速开始.md](./开发指南/快速开始.md)** - 更新为 Supabase 流程
- ✅ **[环境配置.md](./开发指南/环境配置.md)** - 替换 PostgreSQL 为 Supabase
- ✅ **[数据库设计.md](./技术文档/数据库设计.md)** - 添加 Supabase 相关说明
- ✅ **[部署指南.md](./部署运维/部署指南.md)** - 更新环境变量配置
- ✅ `README.md` - 更新技术栈说明

### 为什么选择 Supabase？

1. **零配置部署** - 无需自己维护 PostgreSQL 服务器
2. **完美集成 Vercel** - 部署时自动连接数据库
3. **免费额度充足** - 500MB 存储 + 5GB 带宽/月
4. **开发体验好** - 内置 Table Editor 和 SQL Editor
5. **生产就绪** - Connection Pooling 自动处理高并发
6. **全球 CDN** - 多区域部署，低延迟

### 迁移步骤

如果你是现有用户，请按以下步骤迁移：

#### 1. 创建 Supabase 项目

按照 [Supabase配置指南.md](./技术文档/Supabase配置指南.md) 创建项目。

#### 2. 更新环境变量

修改 `.env` 文件：

```env
# 旧的（本地 PostgreSQL）
# DATABASE_URL="postgresql://user:password@localhost:5432/promptattack"

# 新的（Supabase）
DATABASE_URL="postgres://postgres.[project-ref]:[password]@aws-0-[region].pooler.supabase.com:6543/postgres?pgbouncer=true&connection_limit=1"
DIRECT_URL="postgres://postgres.[project-ref]:[password]@aws-0-[region].pooler.supabase.com:5432/postgres"
```

#### 3. 迁移数据（可选）

如果你有现有数据需要迁移，查看 [Supabase配置指南.md](./技术文档/Supabase配置指南.md#数据迁移) 中的迁移方法。

#### 4. 推送 Schema

```bash
npx prisma generate
npx prisma db push
```

#### 5. 验证

```bash
npx prisma studio
```

或在 Supabase Dashboard 的 Table Editor 中查看表结构。

### 常见问题

**Q: 我能继续使用本地 PostgreSQL 吗？**

A: 可以！只需保持原有的 `DATABASE_URL` 配置即可。Supabase 是推荐方案，但不是强制的。

**Q: Supabase 免费吗？**

A: 是的，Free Plan 提供：

- 500MB 数据库存储
- 5GB 带宽/月
- 60 个并发连接
- 足够个人项目和 MVP 使用

**Q: 如何查看数据库使用情况？**

A: 在 Supabase Dashboard → Settings → Database 中查看存储、连接数等统计。

**Q: 生产环境需要升级 Plan 吗？**

A: 取决于流量。Free Plan 对于小型项目通常足够。如需更多资源，可升级到 Pro Plan（$25/月）。

### 相关资源

- 📖 [Supabase 官方文档](https://supabase.com/docs)
- 📖 [Prisma + Supabase 集成](https://supabase.com/docs/guides/integrations/prisma)
- 📖 [Vercel + Supabase 部署](https://vercel.com/guides/using-supabase-with-vercel)

---

## 之前的更新记录

### 2025-01-15 - 文档重组

- ✅ 完成所有基础文档
- ✅ 重新组织文档结构
- ✅ 使用中文命名
- ✅ 添加分类导航

---

**最后更新**: 2025-01-15
**维护者**: 项目团队
