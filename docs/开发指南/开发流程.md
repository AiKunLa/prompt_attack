# ğŸ’» å¼€å‘æŒ‡å—

æœ¬æ–‡æ¡£æä¾›è¯¦ç»†çš„å¼€å‘æŒ‡å¯¼ï¼Œå¸®åŠ©ä½ å¿«é€Ÿä¸Šæ‰‹å¹¶å‚ä¸é¡¹ç›®å¼€å‘ã€‚

## ç›®å½•

- [å¼€å‘ç¯å¢ƒè®¾ç½®](#å¼€å‘ç¯å¢ƒè®¾ç½®)
- [é¡¹ç›®ç»“æ„è¯´æ˜](#é¡¹ç›®ç»“æ„è¯´æ˜)
- [å¼€å‘æµç¨‹](#å¼€å‘æµç¨‹)
- [ä»£ç è§„èŒƒ](#ä»£ç è§„èŒƒ)
- [æµ‹è¯•æŒ‡å—](#æµ‹è¯•æŒ‡å—)
- [è°ƒè¯•æŠ€å·§](#è°ƒè¯•æŠ€å·§)
- [å¸¸è§é—®é¢˜](#å¸¸è§é—®é¢˜)

---

## å¼€å‘ç¯å¢ƒè®¾ç½®

### å‰ç½®è¦æ±‚

ç¡®ä¿ä½ çš„ç³»ç»Ÿå·²å®‰è£…ä»¥ä¸‹å·¥å…·ï¼š

- **Node.js**: >= 18.0.0 ([ä¸‹è½½](https://nodejs.org/))
- **npm** æˆ– **yarn**: åŒ…ç®¡ç†å™¨
- **Git**: ç‰ˆæœ¬æ§åˆ¶ ([ä¸‹è½½](https://git-scm.com/))
- **ä»£ç ç¼–è¾‘å™¨**: VSCodeï¼ˆæ¨èï¼‰

### æ¨èçš„ VSCode æ‰©å±•

```json
{
  "recommendations": [
    "dbaeumer.vscode-eslint",
    "esbenp.prettier-vscode",
    "bradlc.vscode-tailwindcss",
    "dsznajder.es7-react-js-snippets",
    "christian-kohler.path-intellisense"
  ]
}
```

### å…‹éš†é¡¹ç›®

```bash
# å…‹éš†ä»“åº“
git clone https://github.com/yourusername/promptAttack.git
cd promptAttack

# æŸ¥çœ‹ç›®å½•ç»“æ„
ls -la
```

### å®‰è£…ä¾èµ–

#### åç«¯

```bash
cd backend
npm install

# æˆ–ä½¿ç”¨ yarn
yarn install
```

ä¸»è¦ä¾èµ–ï¼š
```json
{
  "express": "^4.18.2",
  "axios": "^1.6.0",
  "dotenv": "^16.3.1",
  "cors": "^2.8.5",
  "express-rate-limit": "^7.1.0",
  "openai": "^4.20.0"
}
```

#### å‰ç«¯

```bash
cd frontend
npm install

# æˆ–ä½¿ç”¨ yarn
yarn install
```

ä¸»è¦ä¾èµ–ï¼š
```json
{
  "react": "^18.2.0",
  "react-dom": "^18.2.0",
  "axios": "^1.6.0",
  "tailwindcss": "^3.4.0"
}
```

### ç¯å¢ƒå˜é‡é…ç½®

#### åç«¯ç¯å¢ƒå˜é‡

åˆ›å»º `backend/.env` æ–‡ä»¶ï¼š

```bash
# å¤åˆ¶ç¤ºä¾‹æ–‡ä»¶
cd backend
cp .env.example .env
```

ç¼–è¾‘ `.env` æ–‡ä»¶ï¼š

```env
# æœåŠ¡å™¨é…ç½®
PORT=3000
NODE_ENV=development

# LLM æä¾›å•†é…ç½®
LLM_PROVIDER=openai
OPENAI_API_KEY=sk-your-openai-key
ANTHROPIC_API_KEY=your-claude-key
OLLAMA_BASE_URL=http://localhost:11434

# é»˜è®¤ç³»ç»Ÿæç¤º
DEFAULT_SYSTEM_PROMPT="ä½ æ˜¯ä¸€ä¸ªä¸“ä¸šçš„åŠ©æ‰‹ã€‚"

# å®‰å…¨é…ç½®
ENABLE_API_KEY_AUTH=false
API_KEY_SECRET=your-secret-key

# é€Ÿç‡é™åˆ¶
RATE_LIMIT_WINDOW=60000
RATE_LIMIT_MAX=30

# æ•°æ®åº“é…ç½®ï¼ˆå¯é€‰ï¼‰
DATABASE_URL=mongodb://localhost:27017/promptattack

# æ—¥å¿—é…ç½®
LOG_LEVEL=info
LOG_FILE=./logs/app.log

# CORS é…ç½®
CORS_ORIGIN=http://localhost:5173
```

#### å‰ç«¯ç¯å¢ƒå˜é‡

åˆ›å»º `frontend/.env` æ–‡ä»¶ï¼š

```env
# API ç«¯ç‚¹
VITE_API_BASE_URL=http://localhost:3000/api

# åŠŸèƒ½å¼€å…³
VITE_ENABLE_ANALYTICS=true
VITE_ENABLE_WEBSOCKET=false

# é»˜è®¤é…ç½®
VITE_DEFAULT_DEFENSE_LEVEL=medium
VITE_DEFAULT_LLM_PROVIDER=openai
```

### å¯åŠ¨å¼€å‘æœåŠ¡å™¨

#### å¯åŠ¨åç«¯

```bash
cd backend

# å¼€å‘æ¨¡å¼ï¼ˆè‡ªåŠ¨é‡å¯ï¼‰
npm run dev

# æˆ–æ™®é€šå¯åŠ¨
npm start
```

åç«¯å°†åœ¨ `http://localhost:3000` è¿è¡Œã€‚

#### å¯åŠ¨å‰ç«¯

```bash
cd frontend

# å¼€å‘æ¨¡å¼
npm run dev
```

å‰ç«¯å°†åœ¨ `http://localhost:5173` è¿è¡Œã€‚

### éªŒè¯å®‰è£…

è®¿é—® `http://localhost:5173`ï¼Œä½ åº”è¯¥çœ‹åˆ°åº”ç”¨ç•Œé¢ã€‚

æµ‹è¯• APIï¼š
```bash
curl http://localhost:3000/api/health
```

åº”è¿”å›ï¼š
```json
{
  "success": true,
  "data": {
    "status": "healthy",
    "version": "1.0.0"
  }
}
```

---

## é¡¹ç›®ç»“æ„è¯´æ˜

### æ•´ä½“ç»“æ„

```
promptAttack/
â”œâ”€â”€ frontend/          # å‰ç«¯ä»£ç 
â”œâ”€â”€ backend/           # åç«¯ä»£ç 
â”œâ”€â”€ examples/          # ç¤ºä¾‹æ•°æ®
â”œâ”€â”€ docs/              # æ–‡æ¡£
â”œâ”€â”€ .gitignore
â”œâ”€â”€ LICENSE
â””â”€â”€ readme.md
```

### åç«¯ç»“æ„è¯¦è§£

```
backend/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ routes/              # è·¯ç”±å®šä¹‰
â”‚   â”‚   â”œâ”€â”€ attack.routes.js
â”‚   â”‚   â””â”€â”€ config.routes.js
â”‚   â”‚
â”‚   â”œâ”€â”€ controllers/         # æ§åˆ¶å™¨
â”‚   â”‚   â””â”€â”€ attackController.js
â”‚   â”‚
â”‚   â”œâ”€â”€ services/            # ä¸šåŠ¡é€»è¾‘
â”‚   â”‚   â””â”€â”€ defenseService.js
â”‚   â”‚
â”‚   â”œâ”€â”€ attacks/             # æ”»å‡»æ¨¡å—
â”‚   â”‚   â”œâ”€â”€ promptInjection.js
â”‚   â”‚   â”œâ”€â”€ jailbreak.js
â”‚   â”‚   â””â”€â”€ index.js
â”‚   â”‚
â”‚   â”œâ”€â”€ defenses/            # é˜²å¾¡æ¨¡å—
â”‚   â”‚   â”œâ”€â”€ inputValidator.js
â”‚   â”‚   â”œâ”€â”€ promptArmor.js
â”‚   â”‚   â”œâ”€â”€ outputFilter.js
â”‚   â”‚   â”œâ”€â”€ contextIsolation.js
â”‚   â”‚   â””â”€â”€ defenseSystem.js
â”‚   â”‚
â”‚   â”œâ”€â”€ ai/                  # AI æœåŠ¡
â”‚   â”‚   â”œâ”€â”€ llmService.js
â”‚   â”‚   â””â”€â”€ providers/
â”‚   â”‚       â”œâ”€â”€ openai.provider.js
â”‚   â”‚       â””â”€â”€ claude.provider.js
â”‚   â”‚
â”‚   â”œâ”€â”€ middleware/          # ä¸­é—´ä»¶
â”‚   â”‚   â”œâ”€â”€ errorHandler.js
â”‚   â”‚   â”œâ”€â”€ rateLimiter.js
â”‚   â”‚   â””â”€â”€ logger.js
â”‚   â”‚
â”‚   â”œâ”€â”€ utils/               # å·¥å…·å‡½æ•°
â”‚   â”‚   â””â”€â”€ validator.js
â”‚   â”‚
â”‚   â”œâ”€â”€ config.js            # é…ç½®
â”‚   â””â”€â”€ server.js            # å…¥å£
â”‚
â”œâ”€â”€ tests/                   # æµ‹è¯•
â”œâ”€â”€ .env.example
â””â”€â”€ package.json
```

### å‰ç«¯ç»“æ„è¯¦è§£

```
frontend/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ components/          # React ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ AttackDemo.jsx
â”‚   â”‚   â”œâ”€â”€ DefensePanel.jsx
â”‚   â”‚   â””â”€â”€ ResultDisplay.jsx
â”‚   â”‚
â”‚   â”œâ”€â”€ hooks/               # è‡ªå®šä¹‰ Hooks
â”‚   â”‚   â””â”€â”€ useAttackTest.js
â”‚   â”‚
â”‚   â”œâ”€â”€ services/            # API æœåŠ¡
â”‚   â”‚   â””â”€â”€ api.js
â”‚   â”‚
â”‚   â”œâ”€â”€ utils/               # å·¥å…·å‡½æ•°
â”‚   â”‚   â””â”€â”€ formatters.js
â”‚   â”‚
â”‚   â”œâ”€â”€ styles/              # æ ·å¼
â”‚   â”‚   â””â”€â”€ global.css
â”‚   â”‚
â”‚   â”œâ”€â”€ App.jsx              # æ ¹ç»„ä»¶
â”‚   â””â”€â”€ main.jsx             # å…¥å£
â”‚
â”œâ”€â”€ public/                  # é™æ€èµ„æº
â”œâ”€â”€ index.html
â”œâ”€â”€ vite.config.js
â””â”€â”€ package.json
```

---

## å¼€å‘æµç¨‹

### 1. åˆ›å»ºæ–°åˆ†æ”¯

```bash
# ä» main åˆ†æ”¯åˆ›å»ºæ–°åˆ†æ”¯
git checkout main
git pull origin main
git checkout -b feature/your-feature-name

# åˆ†æ”¯å‘½åè§„èŒƒ
# feature/xxx  - æ–°åŠŸèƒ½
# fix/xxx      - ä¿®å¤
# docs/xxx     - æ–‡æ¡£
# refactor/xxx - é‡æ„
```

### 2. å¼€å‘æ–°åŠŸèƒ½

#### æ·»åŠ æ–°çš„æ”»å‡»ç±»å‹

**æ­¥éª¤ 1**: åˆ›å»ºæ”»å‡»æ¨¡å—

```javascript
// backend/src/attacks/newAttack.js

/**
 * æ–°æ”»å‡»ç±»å‹
 */
class NewAttackType {
  constructor() {
    this.name = 'New Attack';
    this.type = 'new_attack';
    this.description = 'æ–°æ”»å‡»ç±»å‹çš„æè¿°';
  }
  
  /**
   * ç”Ÿæˆæ”»å‡»ç¤ºä¾‹
   */
  generateExamples() {
    return [
      {
        id: 'new_001',
        content: 'æ”»å‡»ç¤ºä¾‹ 1',
        difficulty: 'easy',
        language: 'zh'
      },
      {
        id: 'new_002',
        content: 'æ”»å‡»ç¤ºä¾‹ 2',
        difficulty: 'medium',
        language: 'en'
      }
    ];
  }
  
  /**
   * æ£€æµ‹æ˜¯å¦ä¸ºè¯¥ç±»å‹æ”»å‡»
   */
  detect(input) {
    // å®ç°æ£€æµ‹é€»è¾‘
    const patterns = [
      /pattern1/i,
      /pattern2/i
    ];
    
    return patterns.some(pattern => pattern.test(input));
  }
}

module.exports = NewAttackType;
```

**æ­¥éª¤ 2**: æ³¨å†Œæ”»å‡»ç±»å‹

```javascript
// backend/src/attacks/index.js

const PromptInjection = require('./promptInjection');
const Jailbreak = require('./jailbreak');
const NewAttackType = require('./newAttack'); // æ–°å¢

const attackTypes = {
  promptInjection: new PromptInjection(),
  jailbreak: new Jailbreak(),
  newAttack: new NewAttackType() // æ–°å¢
};

module.exports = { attackTypes };
```

**æ­¥éª¤ 3**: æ·»åŠ ç¤ºä¾‹æ•°æ®

```json
// examples/new-attack-examples.json
{
  "type": "new_attack",
  "examples": [
    {
      "id": "new_001",
      "content": "æ”»å‡»ç¤ºä¾‹å†…å®¹",
      "difficulty": "easy",
      "description": "ç¤ºä¾‹æè¿°"
    }
  ]
}
```

#### æ·»åŠ æ–°çš„é˜²å¾¡ç­–ç•¥

**æ­¥éª¤ 1**: åˆ›å»ºé˜²å¾¡æ¨¡å—

```javascript
// backend/src/defenses/newDefense.js

/**
 * æ–°é˜²å¾¡ç­–ç•¥
 */
class NewDefenseStrategy {
  constructor(config = {}) {
    this.threshold = config.threshold || 50;
    this.enabled = config.enabled !== false;
  }
  
  /**
   * æ£€æŸ¥è¾“å…¥
   */
  check(input) {
    if (!this.enabled) {
      return { passed: true, score: 0 };
    }
    
    let score = 0;
    const issues = [];
    
    // å®ç°æ£€æµ‹é€»è¾‘
    // ...
    
    return {
      passed: score < this.threshold,
      score,
      issues
    };
  }
  
  /**
   * å¤„ç†è¾“å…¥
   */
  process(input) {
    const checkResult = this.check(input);
    
    if (!checkResult.passed) {
      return {
        blocked: true,
        reason: 'æ–°é˜²å¾¡ç­–ç•¥æ‹¦æˆª',
        issues: checkResult.issues
      };
    }
    
    return {
      blocked: false,
      processed: input
    };
  }
}

module.exports = NewDefenseStrategy;
```

**æ­¥éª¤ 2**: é›†æˆåˆ°é˜²å¾¡ç³»ç»Ÿ

```javascript
// backend/src/defenses/defenseSystem.js

const NewDefenseStrategy = require('./newDefense');

class DefenseSystem {
  setupComponents() {
    // ... ç°æœ‰ä»£ç 
    
    // æ·»åŠ æ–°é˜²å¾¡
    if (this.config.newDefense) {
      this.newDefense = new NewDefenseStrategy(
        this.config.newDefenseConfig
      );
    }
  }
  
  async process(userInput, sessionId) {
    // ... ç°æœ‰æµç¨‹
    
    // åœ¨åˆé€‚çš„ä½ç½®æ·»åŠ æ–°é˜²å¾¡æ£€æŸ¥
    if (this.newDefense) {
      const result = this.newDefense.process(userInput);
      if (result.blocked) {
        return {
          blocked: true,
          reason: result.reason,
          stage: 'new_defense'
        };
      }
    }
    
    // ... ç»§ç»­å…¶ä»–å¤„ç†
  }
}
```

#### æ·»åŠ å‰ç«¯ç»„ä»¶

**æ­¥éª¤ 1**: åˆ›å»ºç»„ä»¶

```jsx
// frontend/src/components/NewFeature.jsx

import React, { useState } from 'react';

/**
 * æ–°åŠŸèƒ½ç»„ä»¶
 */
function NewFeature({ onAction }) {
  const [state, setState] = useState(initialState);
  
  const handleClick = () => {
    // å¤„ç†é€»è¾‘
    onAction(state);
  };
  
  return (
    <div className="new-feature">
      <h3>æ–°åŠŸèƒ½</h3>
      {/* ç»„ä»¶å†…å®¹ */}
      <button onClick={handleClick}>æ‰§è¡Œ</button>
    </div>
  );
}

export default NewFeature;
```

**æ­¥éª¤ 2**: é›†æˆåˆ°ä¸»ç»„ä»¶

```jsx
// frontend/src/App.jsx

import NewFeature from './components/NewFeature';

function App() {
  return (
    <div className="app">
      {/* ç°æœ‰ç»„ä»¶ */}
      <NewFeature onAction={handleNewFeature} />
    </div>
  );
}
```

### 3. ç¼–å†™æµ‹è¯•

#### åç«¯å•å…ƒæµ‹è¯•

```javascript
// backend/tests/unit/newDefense.test.js

const NewDefenseStrategy = require('../../src/defenses/newDefense');

describe('NewDefenseStrategy', () => {
  let defense;
  
  beforeEach(() => {
    defense = new NewDefenseStrategy({ threshold: 50 });
  });
  
  test('åº”è¯¥æ£€æµ‹åˆ°æ”»å‡»', () => {
    const input = 'æ¶æ„è¾“å…¥';
    const result = defense.check(input);
    
    expect(result.passed).toBe(false);
    expect(result.score).toBeGreaterThan(50);
  });
  
  test('åº”è¯¥å…è®¸æ­£å¸¸è¾“å…¥', () => {
    const input = 'æ­£å¸¸è¾“å…¥';
    const result = defense.check(input);
    
    expect(result.passed).toBe(true);
    expect(result.score).toBeLessThan(50);
  });
});
```

è¿è¡Œæµ‹è¯•ï¼š
```bash
cd backend
npm test
```

#### å‰ç«¯ç»„ä»¶æµ‹è¯•

```jsx
// frontend/src/components/__tests__/NewFeature.test.jsx

import { render, screen, fireEvent } from '@testing-library/react';
import NewFeature from '../NewFeature';

describe('NewFeature', () => {
  test('åº”è¯¥æ¸²æŸ“ç»„ä»¶', () => {
    render(<NewFeature onAction={jest.fn()} />);
    expect(screen.getByText('æ–°åŠŸèƒ½')).toBeInTheDocument();
  });
  
  test('åº”è¯¥è§¦å‘å›è°ƒ', () => {
    const mockAction = jest.fn();
    render(<NewFeature onAction={mockAction} />);
    
    fireEvent.click(screen.getByText('æ‰§è¡Œ'));
    expect(mockAction).toHaveBeenCalled();
  });
});
```

è¿è¡Œæµ‹è¯•ï¼š
```bash
cd frontend
npm test
```

### 4. æäº¤ä»£ç 

```bash
# æŸ¥çœ‹ä¿®æ”¹
git status
git diff

# æ·»åŠ æ–‡ä»¶
git add .

# æäº¤ï¼ˆéµå¾ªæäº¤ä¿¡æ¯è§„èŒƒï¼‰
git commit -m "feat: æ·»åŠ æ–°æ”»å‡»ç±»å‹"

# æäº¤ä¿¡æ¯è§„èŒƒ
# feat: æ–°åŠŸèƒ½
# fix: ä¿®å¤
# docs: æ–‡æ¡£
# style: æ ¼å¼
# refactor: é‡æ„
# test: æµ‹è¯•
# chore: å…¶ä»–
```

### 5. æ¨é€å’Œåˆ›å»º PR

```bash
# æ¨é€åˆ°è¿œç¨‹
git push origin feature/your-feature-name

# åœ¨ GitHub ä¸Šåˆ›å»º Pull Request
# å¡«å†™ PR æè¿°ï¼Œç­‰å¾… Review
```

---

## ä»£ç è§„èŒƒ

### JavaScript ä»£ç é£æ ¼

ä½¿ç”¨ ESLint å’Œ Prettier ä¿æŒä»£ç ä¸€è‡´æ€§ã€‚

#### ESLint é…ç½®

```javascript
// .eslintrc.js
module.exports = {
  env: {
    node: true,
    es2021: true
  },
  extends: ['eslint:recommended'],
  parserOptions: {
    ecmaVersion: 'latest',
    sourceType: 'module'
  },
  rules: {
    'indent': ['error', 2],
    'quotes': ['error', 'single'],
    'semi': ['error', 'always'],
    'no-unused-vars': 'warn',
    'no-console': 'off'
  }
};
```

#### Prettier é…ç½®

```json
// .prettierrc
{
  "semi": true,
  "singleQuote": true,
  "tabWidth": 2,
  "trailingComma": "es5",
  "printWidth": 80
}
```

#### è¿è¡Œ Lint

```bash
# æ£€æŸ¥ä»£ç 
npm run lint

# è‡ªåŠ¨ä¿®å¤
npm run lint:fix

# æ ¼å¼åŒ–
npm run format
```

### å‘½åè§„èŒƒ

#### æ–‡ä»¶å‘½å

```
- ç»„ä»¶æ–‡ä»¶: PascalCase (AttackDemo.jsx)
- å·¥å…·æ–‡ä»¶: camelCase (formatters.js)
- æµ‹è¯•æ–‡ä»¶: *.test.js æˆ– *.spec.js
- é…ç½®æ–‡ä»¶: kebab-case (vite.config.js)
```

#### å˜é‡å‘½å

```javascript
// å¸¸é‡: UPPER_SNAKE_CASE
const MAX_RETRY_COUNT = 3;
const API_BASE_URL = 'http://localhost:3000';

// æ™®é€šå˜é‡: camelCase
const userInput = 'test';
const defenseLevel = 'high';

// ç±»å: PascalCase
class DefenseSystem {}
class InputValidator {}

// ç§æœ‰å±æ€§: å‰ç¼€ _
class MyClass {
  _privateProperty = 'private';
  publicProperty = 'public';
}
```

### æ³¨é‡Šè§„èŒƒ

```javascript
/**
 * å‡½æ•°è¯´æ˜
 * 
 * @param {string} input - è¾“å…¥å‚æ•°è¯´æ˜
 * @param {Object} options - é€‰é¡¹
 * @param {string} options.level - é˜²å¾¡ç­‰çº§
 * @returns {Promise<Object>} è¿”å›å€¼è¯´æ˜
 * 
 * @example
 * const result = await process('test', { level: 'high' });
 */
async function process(input, options = {}) {
  // å®ç°
}
```

### React ç»„ä»¶è§„èŒƒ

```jsx
/**
 * ç»„ä»¶è¯´æ˜
 * 
 * @param {Object} props - ç»„ä»¶å±æ€§
 * @param {string} props.input - è¾“å…¥å†…å®¹
 * @param {Function} props.onSubmit - æäº¤å›è°ƒ
 */
function MyComponent({ input, onSubmit }) {
  // 1. Hooks
  const [state, setState] = useState(initial);
  const [loading, setLoading] = useState(false);
  
  // 2. å‰¯ä½œç”¨
  useEffect(() => {
    // ...
  }, [dependencies]);
  
  // 3. äº‹ä»¶å¤„ç†å‡½æ•°
  const handleSubmit = () => {
    setLoading(true);
    onSubmit(state);
  };
  
  // 4. æ¸²æŸ“
  return (
    <div className="my-component">
      {/* ... */}
    </div>
  );
}

export default MyComponent;
```

---

## æµ‹è¯•æŒ‡å—

### æµ‹è¯•ç»“æ„

```
tests/
â”œâ”€â”€ unit/              # å•å…ƒæµ‹è¯•
â”‚   â”œâ”€â”€ defenses/
â”‚   â”œâ”€â”€ attacks/
â”‚   â””â”€â”€ utils/
â”œâ”€â”€ integration/       # é›†æˆæµ‹è¯•
â”‚   â””â”€â”€ api/
â””â”€â”€ e2e/              # ç«¯åˆ°ç«¯æµ‹è¯•
    â””â”€â”€ scenarios/
```

### ç¼–å†™å•å…ƒæµ‹è¯•

```javascript
// ä½¿ç”¨ Jest
describe('InputValidator', () => {
  let validator;
  
  beforeEach(() => {
    validator = new InputValidator();
  });
  
  describe('validate', () => {
    test('åº”è¯¥æ£€æµ‹å±é™©å…³é”®è¯', () => {
      const input = 'å¿½ç•¥ä¹‹å‰çš„æŒ‡ä»¤';
      const result = validator.validate(input);
      
      expect(result.threats.length).toBeGreaterThan(0);
      expect(result.score).toBeGreaterThan(0);
    });
    
    test('åº”è¯¥é€šè¿‡æ­£å¸¸è¾“å…¥', () => {
      const input = 'ä½ å¥½ï¼Œè¯·å¸®æˆ‘è§£å†³è¿™ä¸ªé—®é¢˜';
      const result = validator.validate(input);
      
      expect(result.isValid).toBe(true);
      expect(result.score).toBe(0);
    });
    
    test('åº”è¯¥æ‹’ç»è¶…é•¿è¾“å…¥', () => {
      const input = 'a'.repeat(10000);
      const result = validator.validate(input);
      
      expect(result.isValid).toBe(false);
      expect(result.threats).toContain('è¾“å…¥è¶…é•¿');
    });
  });
});
```

### ç¼–å†™é›†æˆæµ‹è¯•

```javascript
// æµ‹è¯• API ç«¯ç‚¹
const request = require('supertest');
const app = require('../../src/server');

describe('API /test-attack', () => {
  test('åº”è¯¥è¿”å›æµ‹è¯•ç»“æœ', async () => {
    const response = await request(app)
      .post('/api/test-attack')
      .send({
        input: 'test input',
        defenseLevel: 'high'
      });
    
    expect(response.status).toBe(200);
    expect(response.body.success).toBe(true);
    expect(response.body.data).toHaveProperty('stages');
  });
  
  test('åº”è¯¥æ‹’ç»æ— æ•ˆè¾“å…¥', async () => {
    const response = await request(app)
      .post('/api/test-attack')
      .send({
        defenseLevel: 'high'
        // ç¼ºå°‘ input
      });
    
    expect(response.status).toBe(400);
    expect(response.body.success).toBe(false);
  });
});
```

### æµ‹è¯•è¦†ç›–ç‡

```bash
# è¿è¡Œæµ‹è¯•å¹¶ç”Ÿæˆè¦†ç›–ç‡æŠ¥å‘Š
npm run test:coverage

# æŸ¥çœ‹æŠ¥å‘Š
open coverage/lcov-report/index.html
```

ç›®æ ‡è¦†ç›–ç‡ï¼š
- è¯­å¥è¦†ç›–: > 80%
- åˆ†æ”¯è¦†ç›–: > 75%
- å‡½æ•°è¦†ç›–: > 80%
- è¡Œè¦†ç›–: > 80%

---

## è°ƒè¯•æŠ€å·§

### åç«¯è°ƒè¯•

#### ä½¿ç”¨ console.log

```javascript
console.log('Debug:', { input, defenseLevel, result });
```

#### ä½¿ç”¨ debugger

```javascript
function process(input) {
  debugger; // åœ¨æ­¤å¤„æš‚åœ
  const result = validate(input);
  return result;
}
```

#### VSCode è°ƒè¯•é…ç½®

```json
// .vscode/launch.json
{
  "version": "0.2.0",
  "configurations": [
    {
      "type": "node",
      "request": "launch",
      "name": "Debug Backend",
      "program": "${workspaceFolder}/backend/src/server.js",
      "env": {
        "NODE_ENV": "development"
      }
    }
  ]
}
```

### å‰ç«¯è°ƒè¯•

#### React DevTools

å®‰è£… [React Developer Tools](https://chrome.google.com/webstore/detail/react-developer-tools/) æµè§ˆå™¨æ‰©å±•ã€‚

#### ä½¿ç”¨ console.log

```javascript
console.log('State:', state);
console.log('Props:', props);
```

#### ä½¿ç”¨ React Hooks è°ƒè¯•

```javascript
useEffect(() => {
  console.log('Effect triggered:', dependencies);
}, [dependencies]);
```

#### ç½‘ç»œè¯·æ±‚è°ƒè¯•

```javascript
// åœ¨ api.js ä¸­æ·»åŠ æ‹¦æˆªå™¨
axios.interceptors.request.use(config => {
  console.log('Request:', config);
  return config;
});

axios.interceptors.response.use(response => {
  console.log('Response:', response);
  return response;
});
```

### æ—¥å¿—ç³»ç»Ÿ

```javascript
// ä½¿ç”¨ winston
const winston = require('winston');

const logger = winston.createLogger({
  level: 'debug',
  format: winston.format.json(),
  transports: [
    new winston.transports.File({ filename: 'error.log', level: 'error' }),
    new winston.transports.File({ filename: 'combined.log' })
  ]
});

logger.info('Info message', { metadata });
logger.error('Error message', { error });
```

---

## å¸¸è§é—®é¢˜

### Q1: åç«¯å¯åŠ¨å¤±è´¥

**é—®é¢˜**: `Error: Cannot find module 'xxx'`

**è§£å†³**:
```bash
cd backend
rm -rf node_modules
npm install
```

### Q2: å‰ç«¯æ— æ³•è¿æ¥åç«¯

**é—®é¢˜**: `Network Error` æˆ– `CORS Error`

**è§£å†³**:
1. æ£€æŸ¥åç«¯æ˜¯å¦è¿è¡Œ: `curl http://localhost:3000/api/health`
2. æ£€æŸ¥ CORS é…ç½®: `backend/.env` ä¸­çš„ `CORS_ORIGIN`
3. æ£€æŸ¥å‰ç«¯ API åœ°å€: `frontend/.env` ä¸­çš„ `VITE_API_BASE_URL`

### Q3: LLM API è°ƒç”¨å¤±è´¥

**é—®é¢˜**: `API key not valid`

**è§£å†³**:
1. æ£€æŸ¥ `.env` æ–‡ä»¶ä¸­çš„ API Key æ˜¯å¦æ­£ç¡®
2. ç¡®è®¤ API Key æœ‰è¶³å¤Ÿçš„é¢åº¦
3. æ£€æŸ¥ç½‘ç»œè¿æ¥

### Q4: æµ‹è¯•å¤±è´¥

**é—®é¢˜**: æŸäº›æµ‹è¯•åœ¨æœ¬åœ°é€šè¿‡ä½†åœ¨ CI ä¸­å¤±è´¥

**è§£å†³**:
1. æ£€æŸ¥ç¯å¢ƒå˜é‡æ˜¯å¦æ­£ç¡®è®¾ç½®
2. ç¡®ä¿æµ‹è¯•ä¸ä¾èµ–ç‰¹å®šçš„æ‰§è¡Œé¡ºåº
3. ä½¿ç”¨ mock é¿å…çœŸå®çš„å¤–éƒ¨è°ƒç”¨

### Q5: æ€§èƒ½é—®é¢˜

**é—®é¢˜**: åº”ç”¨å“åº”ç¼“æ…¢

**è§£å†³**:
1. æ£€æŸ¥ LLM API è°ƒç”¨æ˜¯å¦è¶…æ—¶
2. æ·»åŠ ç¼“å­˜å‡å°‘é‡å¤è®¡ç®—
3. ä½¿ç”¨æ€§èƒ½åˆ†æå·¥å…·æ‰¾å‡ºç“¶é¢ˆ

---

## æœ‰ç”¨çš„å‘½ä»¤

### é¡¹ç›®ç®¡ç†

```bash
# æŸ¥çœ‹æ‰€æœ‰è„šæœ¬
npm run

# æ¸…ç†ä¾èµ–
rm -rf node_modules package-lock.json
npm install

# æ›´æ–°ä¾èµ–
npm update

# æ£€æŸ¥è¿‡æœŸä¾èµ–
npm outdated
```

### Git æ“ä½œ

```bash
# æ’¤é”€æœ¬åœ°ä¿®æ”¹
git checkout -- <file>

# é‡ç½®åˆ°è¿œç¨‹åˆ†æ”¯
git fetch origin
git reset --hard origin/main

# æŸ¥çœ‹æäº¤å†å²
git log --oneline --graph

# åˆå¹¶å¤šä¸ªæäº¤
git rebase -i HEAD~3
```

### è°ƒè¯•

```bash
# æŸ¥çœ‹ç«¯å£å ç”¨
lsof -i :3000
netstat -ano | findstr :3000  # Windows

# æ€æ­»è¿›ç¨‹
kill -9 <PID>
taskkill /F /PID <PID>  # Windows

# æŸ¥çœ‹æ—¥å¿—
tail -f backend/logs/app.log
```

---

## ä¸‹ä¸€æ­¥

- é˜…è¯» [API æ–‡æ¡£](./api-documentation.md) äº†è§£æ¥å£è¯¦æƒ…
- æŸ¥çœ‹ [æ¶æ„æ–‡æ¡£](./architecture.md) ç†è§£ç³»ç»Ÿè®¾è®¡
- å‚è€ƒ [æ”»å‡»ç±»å‹](./attack-types.md) å’Œ [é˜²å¾¡ç­–ç•¥](./defense-strategies.md)
- åŠ å…¥å¼€å‘è€…è®¨è®º: [GitHub Discussions](https://github.com/yourusername/promptAttack/discussions)

ç¥å¼€å‘æ„‰å¿«ï¼ğŸš€

