# ğŸ“ é¡¹ç›®ç»“æ„æŒ‡å—

ä»£ç ç»„ç»‡è§„èŒƒå’Œæœ€ä½³å®è·µã€‚

## ğŸ—ï¸ æ¶æ„æ€»è§ˆ

æœ¬é¡¹ç›®éµå¾ª Next.js 14 App Router è§„èŒƒï¼Œé‡‡ç”¨åŠŸèƒ½æ¨¡å—åŒ–æ¶æ„ã€‚

```
prompt-attack/
â”œâ”€â”€ app/              # Next.js App Router (é¡µé¢å’Œ API è·¯ç”±)
â”œâ”€â”€ src/              # åº”ç”¨æºä»£ç 
â”œâ”€â”€ prisma/           # æ•°æ®åº“ Schema å’Œè¿ç§»
â”œâ”€â”€ public/           # é™æ€èµ„æº
â”œâ”€â”€ docs/             # é¡¹ç›®æ–‡æ¡£
â””â”€â”€ é…ç½®æ–‡ä»¶          # TypeScriptã€ESLintã€Tailwind ç­‰
```

## ğŸ“‚ ç›®å½•è¯¦è§£

### `/app` - Next.js App Router

**ç”¨é€”**: é¡µé¢ã€å¸ƒå±€å’Œ API è·¯ç”±ã€‚

```
app/
â”œâ”€â”€ api/                      # API è·¯ç”±
â”‚   â”œâ”€â”€ auth/[...nextauth]/   # NextAuth.js åŠ¨æ€è·¯ç”±
â”‚   â”‚   â””â”€â”€ route.ts          # GET/POST å¤„ç†å™¨
â”‚   â”œâ”€â”€ register/
â”‚   â”‚   â””â”€â”€ route.ts          # POST /api/register
â”‚   â”œâ”€â”€ attack-test/
â”‚   â”‚   â””â”€â”€ route.ts          # POST /api/attack-test
â”‚   â””â”€â”€ health/
â”‚       â””â”€â”€ route.ts          # GET /api/health
â”‚
â”œâ”€â”€ dashboard/                # /dashboard è·¯ç”±
â”‚   â””â”€â”€ page.tsx              # ä»ªè¡¨æ¿é¡µé¢ç»„ä»¶
â”œâ”€â”€ login/                    # /login è·¯ç”±
â”‚   â””â”€â”€ page.tsx              # ç™»å½•é¡µé¢ç»„ä»¶
â”‚
â”œâ”€â”€ layout.tsx                # æ ¹å¸ƒå±€ï¼ˆåŒ…è£¹æ‰€æœ‰é¡µé¢ï¼‰
â”œâ”€â”€ page.tsx                  # é¦–é¡µ (/)
â”œâ”€â”€ providers.tsx             # å®¢æˆ·ç«¯ Providerï¼ˆSessionProviderï¼‰
â””â”€â”€ globals.css               # å…¨å±€æ ·å¼ + Tailwind
```

**çº¦å®š**:

- `page.tsx` = è·¯ç”±é¡µé¢ç»„ä»¶
- `layout.tsx` = å…±äº«å¸ƒå±€
- `route.ts` = API è·¯ç”±å¤„ç†å™¨
- å®¢æˆ·ç«¯ç»„ä»¶ä½¿ç”¨ `"use client"` æŒ‡ä»¤
- é»˜è®¤ä¸ºæœåŠ¡ç«¯ç»„ä»¶

### `/src` - åº”ç”¨æºç 

**ç”¨é€”**: å¯å¤ç”¨ä»£ç ã€ä¸šåŠ¡é€»è¾‘ã€å·¥å…·å‡½æ•°ã€‚

#### `/src/components` - React ç»„ä»¶

```
src/components/
â”œâ”€â”€ ui/                  # shadcn/ui ç»„ä»¶ï¼ˆåŸå­çº§ï¼‰
â”‚   â”œâ”€â”€ button.tsx
â”‚   â”œâ”€â”€ input.tsx
â”‚   â”œâ”€â”€ card.tsx
â”‚   â””â”€â”€ ...              # æŒ‰éœ€æ·»åŠ æ›´å¤š
â”‚
â””â”€â”€ [feature]/           # åŠŸèƒ½ç‰¹å®šç»„ä»¶
    â””â”€â”€ example.tsx
```

**çº¦å®š**:

- `ui/` = å±•ç¤ºå‹ç»„ä»¶ï¼ˆshadcn/uiï¼‰
- åŠŸèƒ½æ–‡ä»¶å¤¹ = é¢†åŸŸç‰¹å®šç»„ä»¶
- ä½¿ç”¨ PascalCase å‘½åç»„ä»¶æ–‡ä»¶
- å¯¼å‡ºå‘½åç»„ä»¶

#### `/src/features` - åŠŸèƒ½æ¨¡å—

```
src/features/
â””â”€â”€ [feature-name]/
    â”œâ”€â”€ components/      # åŠŸèƒ½ç»„ä»¶
    â”œâ”€â”€ hooks/           # åŠŸèƒ½ Hook
    â”œâ”€â”€ types.ts         # åŠŸèƒ½ç±»å‹
    â”œâ”€â”€ api.ts           # API è°ƒç”¨
    â””â”€â”€ index.ts         # å…¬å¼€å¯¼å‡º
```

**ç¤ºä¾‹**ï¼ˆæœªæ¥ï¼‰:

```
src/features/
â””â”€â”€ attack-defense/
    â”œâ”€â”€ components/
    â”‚   â”œâ”€â”€ AttackInput.tsx
    â”‚   â””â”€â”€ DefenseConfig.tsx
    â”œâ”€â”€ hooks/
    â”‚   â””â”€â”€ useDefenseSystem.ts
    â”œâ”€â”€ types.ts
    â””â”€â”€ api.ts
```

**çº¦å®š**:

- ä¸€ä¸ªåŠŸèƒ½ = ä¸€ä¸ªç›®å½•
- ä¿æŒåŠŸèƒ½éš”ç¦»
- é€šè¿‡ `index.ts` å¯¼å‡º

#### `/src/lib` - æ ¸å¿ƒåº“

```
src/lib/
â”œâ”€â”€ db.ts               # Prisma å®¢æˆ·ç«¯å•ä¾‹
â”œâ”€â”€ auth.ts             # NextAuth é…ç½®
â”œâ”€â”€ auth-helpers.ts     # è®¤è¯å·¥å…·
â””â”€â”€ store.ts            # Zustand Store
```

**ç”¨é€”**: æ ¸å¿ƒåŸºç¡€è®¾æ–½å’Œé…ç½®ã€‚

**çº¦å®š**:

- ä¿æŒæœ€å°åŒ– - ä»…å…±äº«åŸºç¡€è®¾æ–½
- æ— ä¸šåŠ¡é€»è¾‘
- ä»…æœåŠ¡ç«¯å®‰å…¨ä»£ç 

#### `/src/types` - TypeScript ç±»å‹

```
src/types/
â”œâ”€â”€ index.ts            # å…±äº«ç±»å‹
â””â”€â”€ next-auth.d.ts      # NextAuth ç±»å‹æ‰©å±•
```

**çº¦å®š**:

- å…¨å±€ç±»å‹æ”¾åœ¨ `index.ts`
- æ¨¡å—æ‰©å±•æ”¾åœ¨ `.d.ts` æ–‡ä»¶
- ä¼˜å…ˆä½¿ç”¨ Zod Schema + ç±»å‹æ¨æ–­

#### `/src/utils` - å·¥å…·å‡½æ•°

```
src/utils/
â”œâ”€â”€ cn.ts               # Tailwind ç±»ååˆå¹¶
â”œâ”€â”€ errors.ts           # é”™è¯¯ç±»
â””â”€â”€ validators.ts       # Zod éªŒè¯ Schema
```

**çº¦å®š**:

- ä»…çº¯å‡½æ•°
- è‰¯å¥½æ–‡æ¡£
- å¯æµ‹è¯•

#### `/src/hooks` - è‡ªå®šä¹‰ React Hook

```
src/hooks/
â”œâ”€â”€ useAttackTest.ts    # æ”»å‡»æµ‹è¯• Hook
â””â”€â”€ ...
```

**çº¦å®š**:

- ä»¥ `use` å¼€å¤´
- ä¸€ä¸ª Hook ä¸€ä¸ªæ–‡ä»¶
- è®°å½•å‚æ•°

### `/prisma` - æ•°æ®åº“

```
prisma/
â”œâ”€â”€ schema.prisma       # æ•°æ®åº“ Schema
â””â”€â”€ migrations/         # è¿ç§»å†å²ï¼ˆè‡ªåŠ¨ç”Ÿæˆï¼‰
```

**çº¦å®š**:

- ä»…ç¼–è¾‘ `schema.prisma`
- è¿è¡Œ `prisma migrate dev` è¿›è¡Œå˜æ›´
- ç»ä¸æ‰‹åŠ¨ç¼–è¾‘è¿ç§»æ–‡ä»¶

### `/docs` - é¡¹ç›®æ–‡æ¡£

```
docs/
â”œâ”€â”€ å¼€å‘æŒ‡å—/
â”‚   â”œâ”€â”€ å¿«é€Ÿå¼€å§‹.md
â”‚   â”œâ”€â”€ ç¯å¢ƒé…ç½®.md
â”‚   â”œâ”€â”€ é¡¹ç›®ç»“æ„.md
â”‚   â””â”€â”€ å¼€å‘è§„èŒƒ.md
â”œâ”€â”€ æŠ€æœ¯æ–‡æ¡£/
â”‚   â”œâ”€â”€ APIæ–‡æ¡£.md
â”‚   â”œâ”€â”€ æ•°æ®åº“è®¾è®¡.md
â”‚   â””â”€â”€ è®¤è¯ç³»ç»Ÿ.md
â”œâ”€â”€ ä¸šåŠ¡æ–‡æ¡£/
â”‚   â”œâ”€â”€ æ”»å‡»ç±»å‹è¯¦è§£.md
â”‚   â”œâ”€â”€ é˜²å¾¡ç­–ç•¥è¯¦è§£.md
â”‚   â””â”€â”€ ç³»ç»Ÿæ¶æ„.md
â””â”€â”€ éƒ¨ç½²è¿ç»´/
    â””â”€â”€ éƒ¨ç½²æŒ‡å—.md
```

## ğŸ¯ æ–‡ä»¶å‘½åè§„èŒƒ

| ç±»å‹         | è§„èŒƒ                  | ç¤ºä¾‹                         |
| ------------ | --------------------- | ---------------------------- |
| **ç»„ä»¶**     | PascalCase.tsx        | `AttackDemo.tsx`             |
| **é¡µé¢**     | lowercase/kebab-case  | `app/dashboard/page.tsx`     |
| **å·¥å…·**     | camelCase.ts          | `cn.ts`                      |
| **ç±»å‹**     | camelCase.ts æˆ– .d.ts | `index.ts`, `next-auth.d.ts` |
| **Hook**     | useCamelCase.ts       | `useAttackTest.ts`           |
| **API è·¯ç”±** | route.ts              | `app/api/*/route.ts`         |

## ğŸ“ ä»£ç ç»„ç»‡æ¨¡å¼

### æ¨¡å¼ 1: å°±è¿‘åŸåˆ™

ç›¸å…³ä»£ç æ”¾åœ¨ä¸€èµ·ï¼š

```tsx
// âœ… æ¨è
src/features/attack-defense/
â”œâ”€â”€ components/
â”‚   â””â”€â”€ AttackInput.tsx
â”œâ”€â”€ hooks/
â”‚   â””â”€â”€ useAttackInput.ts
â””â”€â”€ types.ts

// âŒ é¿å…
src/components/AttackInput.tsx
src/hooks/useAttackInput.ts
src/types/attack-types.ts
```

### æ¨¡å¼ 2: æ¡¶å¼å¯¼å‡º

ä½¿ç”¨ `index.ts` å®ç°æ¸…æ™°å¯¼å…¥ï¼š

```typescript
// src/features/attack-defense/index.ts
export { AttackInput } from './components/AttackInput';
export { useAttackInput } from './hooks/useAttackInput';
export type { AttackInputProps } from './types';

// ä½¿ç”¨
import { AttackInput, useAttackInput } from '@/features/attack-defense';
```

### æ¨¡å¼ 3: æœåŠ¡ç«¯/å®¢æˆ·ç«¯åˆ†ç¦»

```tsx
// âœ… æœåŠ¡ç«¯ç»„ä»¶ï¼ˆé»˜è®¤ï¼‰
// app/dashboard/page.tsx
import { getServerSession } from 'next-auth';

export default async function DashboardPage() {
  const session = await getServerSession();
  return <ClientComponent session={session} />;
}

// âœ… å®¢æˆ·ç«¯ç»„ä»¶ï¼ˆæ˜¾å¼ï¼‰
// src/components/ClientComponent.tsx
('use client');

import { useState } from 'react';

export function ClientComponent({ session }) {
  const [state, setState] = useState();
  // ...
}
```

## ğŸ” å¯¼å…¥è·¯å¾„åˆ«å

åœ¨ `tsconfig.json` ä¸­é…ç½®ï¼š

```typescript
// å¯ç”¨åˆ«å
import { Button } from '@/components/ui/button';
import { useAttackTest } from '@/hooks/useAttackTest';
import { prisma } from '@/lib/db';
import type { ApiResponse } from '@/types';
import { cn } from '@/utils/cn';
```

## ğŸ“Š çŠ¶æ€ç®¡ç†ç­–ç•¥

### 1. æœåŠ¡ç«¯çŠ¶æ€ï¼ˆæ•°æ®åº“ï¼‰

- åœ¨æœåŠ¡ç«¯ç»„ä»¶æˆ– API è·¯ç”±ä¸­ä½¿ç”¨ Prisma æŸ¥è¯¢
- æ— å®¢æˆ·ç«¯ç¼“å­˜

### 2. å®¢æˆ·ç«¯çŠ¶æ€ï¼ˆZustandï¼‰

- å…¨å±€çŠ¶æ€: `src/lib/store.ts`
- åŠŸèƒ½çŠ¶æ€: `src/features/[name]/store.ts`

### 3. URL çŠ¶æ€

- ä½¿ç”¨ Next.js `searchParams` å¤„ç†è¿‡æ»¤ã€åˆ†é¡µç­‰

### 4. è¡¨å•çŠ¶æ€

- ä½¿ç”¨å—æ§ç»„ä»¶ + `useState`
- æˆ–å¤æ‚è¡¨å•ä½¿ç”¨ React Hook Form

## ğŸ§ª æµ‹è¯•ç»“æ„ï¼ˆæœªæ¥ï¼‰

```
__tests__/
â”œâ”€â”€ unit/
â”‚   â”œâ”€â”€ components/
â”‚   â”œâ”€â”€ hooks/
â”‚   â””â”€â”€ utils/
â”œâ”€â”€ integration/
â”‚   â””â”€â”€ api/
â””â”€â”€ e2e/
    â””â”€â”€ flows/
```

## ğŸ“¦ æ·»åŠ æ–°åŠŸèƒ½

### æ­¥éª¤

1. **åˆ›å»ºåŠŸèƒ½ç›®å½•**:

   ```
   src/features/my-feature/
   ```

2. **æ·»åŠ ç»„ä»¶**:

   ```typescript
   src / features / my - feature / components / MyComponent.tsx;
   ```

3. **æ·»åŠ ç±»å‹**:

   ```typescript
   src / features / my - feature / types.ts;
   ```

4. **æ·»åŠ  Hook**ï¼ˆå¦‚éœ€ï¼‰:

   ```typescript
   src / features / my - feature / hooks / useMyFeature.ts;
   ```

5. **æ·»åŠ  API è·¯ç”±**ï¼ˆå¦‚éœ€ï¼‰:

   ```typescript
   app / api / my - feature / route.ts;
   ```

6. **é€šè¿‡ index å¯¼å‡º**:
   ```typescript
   src / features / my - feature / index.ts;
   ```

## ğŸ¨ æ ·å¼è§„èŒƒ

1. **ä½¿ç”¨ Tailwind** è¿›è¡Œæ‰€æœ‰æ ·å¼è®¾ç½®
2. **ä½¿ç”¨ `cn()` å·¥å…·** å¤„ç†æ¡ä»¶ç±»å
3. **éµå¾ª shadcn/ui æ¨¡å¼** æ„å»ºç»„ä»¶
4. **ä¿æŒå†…è”** - é¿å…å•ç‹¬çš„ CSS æ¨¡å—

```tsx
// âœ… æ¨è
<div
  className={cn('flex items-center gap-2', isActive && 'bg-primary', className)}
>
  {children}
</div>
```

## ğŸ”’ å®‰å…¨æœ€ä½³å®è·µ

1. **API è·¯ç”±**: ä½¿ç”¨ Zod éªŒè¯æ‰€æœ‰è¾“å…¥
2. **æ•°æ®åº“**: ä½¿ç”¨ Prisma - ç»ä¸ä½¿ç”¨åŸå§‹ SQL
3. **è®¤è¯**: åœ¨å—ä¿æŠ¤è·¯ç”±ä¸­æ£€æŸ¥ä¼šè¯
4. **å¯†é’¥**: å­˜å‚¨åœ¨ `.env`ï¼Œç»ä¸æ”¾åœ¨ä»£ç ä¸­
5. **å®¢æˆ·ç«¯/æœåŠ¡ç«¯**: ä¸è¦å‘å®¢æˆ·ç«¯æš´éœ²æœåŠ¡ç«¯ä»£ç 

---

**æœ€åæ›´æ–°**: 2025-01-15
**ç»´æŠ¤è€…**: é¡¹ç›®å›¢é˜Ÿ
